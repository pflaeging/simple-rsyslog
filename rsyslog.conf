$ModLoad omstdout.so       # provide messages to stdout

# Provides UDP syslog reception
$ModLoad imudp
$UDPServerRun 1514

# Provides TCP syslog reception
# make gtls driver the default
$DefaultNetstreamDriver gtls
# certificate files
$DefaultNetstreamDriverCAFile /etc/syslogcerts/ca.pem
$DefaultNetstreamDriverCertFile /etc/syslogcerts/server-cert.pem
$DefaultNetstreamDriverKeyFile /etc/syslogcerts/server-key.pem
$ModLoad imtcp  # TCP listener

$InputTCPServerStreamDriverMode 1  # run driver in TLS-only mode
$InputTCPServerStreamDriverAuthMode anon
$InputTCPServerRun 10514  # start up listener at port 10514


#### GLOBAL DIRECTIVES ####

# Where to place auxiliary files
$WorkDirectory /var/lib/rsyslog

# Use default timestamp format
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat


#### RULES ####

# Actions
*.* :omstdout:             # send everything to stdout

# Log anything (except mail) of level info or higher.
# Don't log private authentication messages!
*.info;mail.none;authpriv.none;cron.none                /var/log/messages
#